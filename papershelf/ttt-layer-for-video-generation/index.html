<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>404EngineerNotFound</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin=anonymous referrerpolicy=no-referrer></head><body>\<header><nav><div class=logo><a href=/>404EngineerNotFound</a></div><ul class=main-nav><li class="nav-item has-dropdown"><a href=#>Writings <i class="fas fa-caret-down fa-xs"></i></a><ul class=dropdown-menu><li class=dropdown-item><a href=/stories/>Stories</a></li><li class=dropdown-item><a href=/thoughts/>Thoughts</a></li><li class=dropdown-item><a href=/fitness-log/>Fitness Log</a></li></ul></li><li class="nav-item has-dropdown"><a href=#>Tech Lab <i class="fas fa-caret-down fa-xs"></i></a><ul class=dropdown-menu><li class=dropdown-item><a href=/papershelf/>Papershelf</a></li><li class=dropdown-item><a href=/creations/>Creations</a></li><li class=dropdown-item><a href=/dsa-log/>DSA Log</a></li><li class=dropdown-item><a href=/tech-writings/>Technical Writings</a></li></ul></li><li class=nav-item><a href=/bookshelf/>Bookshelf</a></li><li class=nav-item><a href=/about/>About</a></li></ul></nav></header><main><article class=paper-single><div class=paper-categories>Filed under:
<span class=category-pill>AI</span></div><h1>One-Minute Video Generation with Test-Time Training</h1><span class=reading-time><em>6 min read</em></span><div class=paper-content><p><a href=https://test-time-training.github.io/video-dit/>Website</a></p><h2 id=tldr>TLDR;</h2><p>They tackled long video generation by replacing expensive global attention with efficient local attention, and bridging the gaps between local segments using novel TTT layers. These TTT layers act like RNNs but have a much smarter, adaptive hidden state (a neural network that learns on-the-fly during generation). This allows them to capture long-range dependencies and complex dynamics better than traditional RNNs, leading to more coherent minute-long videos, albeit with some remaining artifacts and efficiency challenges.</p><h3 id=whats-the-problem-they-are-trying-to-solve>What&rsquo;s the Problem they are trying to solve?</h3><p>they want to create long videos, like a full minute long, that tell a coherent story with multiple scenes and characters doing things (like Tom chasing Jerry). Think of generating a mini-cartoon episode from a text description.</p><p>The main hurdle? <strong>Memory and Computation.</strong></p><ul><li><p><a href>1.</a> <strong>Transformers (The Standard Powerhouse)</strong>: These models are amazing for many things, but they use something called &ldquo;self-attention.&rdquo; Imagine every frame in the video needing to look back and compare itself to every other frame that came before it. For a few seconds, this is fine. But for a minute-long video (which can be thousands of frames or tokens!), the computation becomes astronomically expensive – it scales quadratically (if you double the length, the cost goes up by four times!). It&rsquo;s like trying to have a conversation where, before speaking, you have to re-read the entire transcript of everything said so far.</p></li><li><p><a href>2.</a> <strong>RNNs / State-Space Models (Like Mamba, DeltaNet - The Efficient Alternatives)</strong> : These are designed to be more efficient for long sequences. Their cost scales linearly (double the length, double the cost). Think of them like reading a book: you maintain a &ldquo;summary&rdquo; or &ldquo;hidden state&rdquo; in your head that captures the story so far, and you update it as you read each new word. Much faster.</p><ul><li><a href>2.1.</a> <em>The Catch:</em> The &ldquo;summary&rdquo; these models keep (their hidden state) is usually quite simple, often just a matrix of numbers. While efficient, we found this simple summary isn&rsquo;t expressive enough to capture the complex details needed for a dynamic, multi-scene story like Tom and Jerry. It struggles to remember specific details from long ago or juggle multiple interacting elements coherently. It&rsquo;s like trying to summarize a complex movie plot in just one short sentence – you lose too much information.</li></ul></li></ul><h3 id=core-idea-test-time-training-ttt-layers>Core Idea: Test-Time Training (TTT) Layers</h3><p>So, we need the efficiency of RNNs but the expressiveness that approaches Transformers. How? We introduced Test-Time Training (TTT) Layers. Here&rsquo;s the intuition:</p><ul><li><ol><li>RNNs Revisited: Think of any RNN layer. It takes an input (xt) and its current &ldquo;memory&rdquo; or hidden state (Wt-1), updates that memory (Wt), and produces an output (zt).</li></ol></li></ul><figure><img src=/papershelf/assets/ttt-video-generation/ttt-eq-1.png alt=Figure width=750></figure><ul><li><ol start=2><li>Making the Memory Smarter: What if, instead of the hidden state (Wt) being just a passive matrix of numbers, it was itself a small neural network (f)? A mini-brain, if you will.</li></ol></li><li><ol start=3><li>Learning On-The-Fly: Now, here&rsquo;s the key TTT part: As each new piece of the video sequence (xt) comes in during generation (at &ldquo;test time&rdquo;), we actually perform a tiny bit of training on this mini-brain hidden state. We update the weights (W) of this internal network f based on the input xt it just saw (using a quick gradient descent step, Equation 1).</li></ol></li></ul><figure><img src=/papershelf/assets/ttt-video-generation/ttt-eq-1.png alt=image width=750></figure><ul><li><ol start=4><li><p>Why &ldquo;Test-Time Training&rdquo;? Because this training/updating of the hidden state (W) happens while the model is generating the video (test time), not just during the initial, large-scale training phase.</p><ul><li>4.1 <em>The Benefit</em> : Because the hidden state is now an active, learning neural network (they used a simple 2-layer MLP, see Section 2.3), it can potentially store much richer, more complex information than a static matrix. It adapts and learns specifically for the sequence it&rsquo;s currently processing. This gives it a better chance to remember long-range dependencies and handle complex scene changes. It&rsquo;s like having a smarter, adaptive summary that actively learns as the story unfolds.</li></ul></li></ol></li></ul><h3 id=putting-ttt-into-a-video-model-section-3>Putting TTT into a Video Model (Section 3):</h3><ul><li><ol><li>Base Model: They didn&rsquo;t start from scratch. We took a powerful pre-trained video generation model (CogVideo-X 5B) which was good at generating short (3-second) clips. The Problem: CogVideo-X uses standard Transformer attention, which is too slow for one minute.
The Approach (Figure 3):<figure><img src=/papershelf/assets/ttt-video-generation/ttt-arch.png alt="Figure 3" width=1000></figure></li></ol></li><li><ol start=2><li>Local Attention: We keep the original Transformer self-attention layers but make them local. They only look at frames within their own 3-second segment. This keeps them fast.</li></ol></li><li><ol start=3><li>Global TTT: We insert our TTT layers. Since TTT layers are efficient (linear cost), we run them globally across the entire one-minute sequence. They act as the connective tissue, passing information between the 3-second segments that the local attention layers can&rsquo;t see.</li></ol></li><li><ol start=4><li>Gating (Eq 6): When you add new layers (like TTT) to a pre-trained model, you don&rsquo;t want them to mess things up initially. We use a &ldquo;gate&rdquo; (a learnable multiplier tanh(α)) that starts close to zero. This means, at first, the TTT layer&rsquo;s output is mostly ignored. As the model fine-tunes, it can learn to &ldquo;open the gate&rdquo; (α increases) if the TTT layer proves helpful.</li></ol></li><li><ol start=5><li>Bi-direction (Eq 7): Video models often need to understand context from both past and future frames. Standard RNNs/TTT only look backward. So, we use a standard trick: run one TTT layer forward, and another identical TTT layer (TTT&rsquo;) backward over the sequence, then combine their results. This gives each position information flowing from both directions.</li></ol></li><li><ol start=6><li>Segmentation: We process the video in 3-second chunks for the local attention, but the TTT layers see the whole concatenated sequence of chunks. Text prompts are also associated with these chunks (Format 3 storyboard).
Training: We fine-tuned this modified architecture on our Tom and Jerry dataset, starting with short clips and gradually increasing the length (multi-stage context extension, Section 3.3).</li></ol></li></ul><h3 id=evaluation-and-results-section-4>Evaluation and Results (Section 4):</h3><ul><li><ol><li>They compared our TTT-MLP approach against strong baselines like Mamba 2, Gated DeltaNet (state-of-the-art RNNs), sliding-window attention, and a simpler TTT-Linear (where the hidden state f is just a linear layer, not an MLP).</li></ol></li><li><ol start=2><li>Key Finding: For long (one-minute) videos with complex stories, TTT-MLP performed significantly better than the baselines, especially in &ldquo;Temporal Consistency&rdquo; (making sense over time) and &ldquo;Motion Naturalness&rdquo; (realistic movement). It won by 34 Elo points on average in human evaluations (Table 1), which is a meaningful difference.</li></ol></li><li><ol start=3><li>Short Videos: Interestingly, for shorter 18-second videos (Table 3 in Appendix), Gated DeltaNet was slightly better, suggesting that the richer hidden state of TTT-MLP really shines when the context gets very long and complex.</li></ol></li><li><ol start=4><li>Limitations (Sec 4.4): It&rsquo;s not perfect! Videos still have artifacts (weird physics, morphing objects - see Fig 7). It&rsquo;s also computationally slower than Mamba or DeltaNet (Fig 6). The quality is also limited by the base CogVideo-X model.</li></ol></li></ul></div><hr><div class=paper-reference><p><strong>Read the original paper:</strong>
<a href=https://arxiv.org/pdf/2504.05298 target=_blank rel="noopener noreferrer">One-Minute Video Generation with Test-Time Training</a></p><p class=paper-disclaimer><em>The content presented here is a collection of my personal notes and explanations based on the paper. This is by no means an exhaustive explanation, and I strongly encourage you to read the actual paper for a comprehensive understanding.</em></p></div></article></main><footer><p>&copy; 2025 Deepanshu Kandpal</p></footer></body></html>